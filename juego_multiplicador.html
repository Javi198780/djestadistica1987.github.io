<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ðŸš€ Nave MatemÃ¡tica - Multiplicaciones</title>

<style>
  body {
    background: radial-gradient(circle at center, #000015, #000);
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    color: white;
    text-align: center;
  }

  #gameTitle {
    margin: 10px 0;
    font-size: 22px;
    font-weight: bold;
    color: cyan;
    text-shadow: 0 0 8px cyan;
  }

  canvas {
    background: linear-gradient(to bottom, #002244, #000010);
    border: 3px solid cyan;
    display: block;
    margin: 10px auto;
    border-radius: 12px;
    touch-action: none;

    /* Mantener forma correcta */
    width: 100%;
    max-width: 600px;
    aspect-ratio: 600 / 420;
  }

  /* Controles tÃ¡ctiles */
  #controles {
    margin-top: 10px;
    display: flex;
    justify-content: center;
    gap: 15px;
  }

  #controles button {
    background: #111;
    color: cyan;
    border: 2px solid cyan;
    padding: 15px 25px;
    font-size: 20px;
    border-radius: 10px;
    touch-action: manipulation;
  }

</style>
</head>

<body>

<h2 id="gameTitle">ðŸš€ Nave MatemÃ¡tica - Multiplicaciones</h2>

<canvas id="canvas" width="600" height="420"></canvas>

<div id="controles">
  <button id="btnLeft">â—€</button>
  <button id="btnShoot">ðŸ”¥</button>
  <button id="btnRight">â–¶</button>
</div>

<script>
/* ---------------------------
   VARIABLES DEL CANVAS
----------------------------*/
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let leftPressed = false;
let rightPressed = false;

let ultimoDisparo = 0;

/* ---------------------------
   NAVE
----------------------------*/
const nave = {
  x: 300 - 20,
  y: 360,
  w: 40,
  h: 40,
  speed: 5
};

/* ---------------------------
   BALAS
----------------------------*/
let balas = [];

function disparar() {
  const ahora = performance.now();
  if (ahora - ultimoDisparo < 250) return;
  ultimoDisparo = ahora;

  balas.push({
    x: nave.x + nave.w/2 - 2,
    y: nave.y - 10,
    w: 4,
    h: 12
  });
}

/* ---------------------------
   METEORITOS
----------------------------*/
let meteoritos = [];

function crearMeteorito() {
  const x = Math.random() * (canvas.width - 40);
  meteoritos.push({
    x,
    y: -40,
    w: 40,
    h: 40,
    speed: 1 + Math.random() * 2
  });
}

setInterval(crearMeteorito, 1000);

/* ---------------------------
   DIBUJAR ELEMENTOS
----------------------------*/
function drawNave() {
  ctx.fillStyle = "cyan";
  ctx.fillRect(nave.x, nave.y, nave.w, nave.h);
}

function drawBalas() {
  ctx.fillStyle = "yellow";
  balas.forEach(b => {
    ctx.fillRect(b.x, b.y, b.w, b.h);
  });
}

function drawMeteoritos() {
  ctx.fillStyle = "red";
  meteoritos.forEach(m => {
    ctx.fillRect(m.x, m.y, m.w, m.h);
  });
}

/* ---------------------------
   MOVIMIENTOS
----------------------------*/
function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (leftPressed && nave.x > 0) nave.x -= nave.speed;
  if (rightPressed && nave.x + nave.w < canvas.width) nave.x += nave.speed;

  balas.forEach(b => b.y -= 5);
  balas = balas.filter(b => b.y > -20);

  meteoritos.forEach(m => m.y += m.speed);
  meteoritos = meteoritos.filter(m => m.y < canvas.height + 40);

  drawNave();
  drawBalas();
  drawMeteoritos();

  requestAnimationFrame(update);
}

update();

/* ---------------------------
   EVENTOS DE TECLADO (PC)
----------------------------*/
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") leftPressed = true;
  if (e.key === "ArrowRight") rightPressed = true;
  if (e.key === " ") disparar();
});

document.addEventListener("keyup", e => {
  if (e.key === "ArrowLeft") leftPressed = false;
  if (e.key === "ArrowRight") rightPressed = false;
});

/* ---------------------------
   CONTROLES TÃCTILES (CELULAR)
----------------------------*/
const btnLeft = document.getElementById("btnLeft");
const btnRight = document.getElementById("btnRight");
const btnShoot = document.getElementById("btnShoot");

/* BotÃ³n disparar */
btnShoot.addEventListener("pointerdown", e => { e.preventDefault(); disparar(); }, { passive: false });
btnShoot.addEventListener("touchstart", e => { e.preventDefault(); disparar(); }, { passive: false });
btnShoot.addEventListener("click", e => { e.preventDefault(); disparar(); });

/* Izquierda */
btnLeft.addEventListener("pointerdown", e => { e.preventDefault(); leftPressed = true; }, { passive: false });
btnLeft.addEventListener("pointerup",   e => { e.preventDefault(); leftPressed = false; }, { passive: false });
btnLeft.addEventListener("touchend",    e => { leftPressed = false; });

/* Derecha */
btnRight.addEventListener("pointerdown", e => { e.preventDefault(); rightPressed = true; }, { passive: false });
btnRight.addEventListener("pointerup",   e => { e.preventDefault(); rightPressed = false; }, { passive: false });
btnRight.addEventListener("touchend",    e => { rightPressed = false; });

</script>

</body>
</html>
