<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>游 Nave Matem치tica - Multiplicaciones</title>

<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #000;
    font-family: Arial, sans-serif;
  }

  #score, #pregunta {
    position: absolute;
    top: 10px;
    left: 10px;
    padding: 8px 14px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    font-size: 20px;
    border-radius: 8px;
  }

  #pregunta {
    top: 50px;
  }

  canvas {
    display: block;
  }

  #explosionSound {
    display: none;
  }
</style>
</head>

<body>

<div id="score">Puntuaci칩n: 0</div>
<div id="pregunta">Pregunta: 0 칑 0</div>

<audio id="explosionSound" src="explosion.mp3"></audio>

<canvas id="canvas"></canvas>

<script>
// =========================================
// CONFIGURACI칍N INICIAL
// =========================================

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// 游늷 IM츼GENES DEL JUEGO
const imgNave = new Image();
imgNave.src = "nave.png";

const imgMeteorito = new Image();
imgMeteorito.src = "meteorito.png";

const imgFondo = new Image();
imgFondo.src = "espacio.png";

const explosionSound = document.getElementById("explosionSound");

// Estado del juego
let score = 0;
let factor1 = 0;
let factor2 = 0;
let respuestaCorrecta = 0;

document.getElementById("score").innerText = "Puntuaci칩n: " + score;

// Genera nueva pregunta
function nuevaPregunta() {
  factor1 = Math.floor(Math.random() * 10) + 1;
  factor2 = Math.floor(Math.random() * 10) + 1;
  respuestaCorrecta = factor1 * factor2;

  document.getElementById("pregunta").innerText =
    "Pregunta: " + factor1 + " 칑 " + factor2;
}
nuevaPregunta();


// =========================================
// NAVE
// =========================================

const nave = {
  x: canvas.width / 2 - 40,
  y: canvas.height - 140,
  w: 80,
  h: 100,
  speed: 20
};

// Dibujar nave con imagen
function drawNave() {
  ctx.drawImage(imgNave, nave.x, nave.y, nave.w, nave.h);
}

// Movimiento t치ctil
let touchX = null;

canvas.addEventListener("touchstart", (e) => {
  touchX = e.touches[0].clientX;
});

canvas.addEventListener("touchmove", (e) => {
  touchX = e.touches[0].clientX;
  nave.x = touchX - nave.w / 2;
});

// Movimiento con teclado
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowLeft") nave.x -= nave.speed;
  if (e.key === "ArrowRight") nave.x += nave.speed;
});


// =========================================
// METEORITOS
// =========================================

let meteoritos = [];

function crearMeteorito() {
  let valor = Math.floor(Math.random() * 81) + 1;

  meteoritos.push({
    x: Math.random() * (canvas.width - 50) + 25,
    y: -20,
    r: 60,
    valor: valor,
    speed: 3 + Math.random() * 3
  });
}

// Dibujar meteoritos con imagen
function drawMeteoritos() {
  meteoritos.forEach((m) => {
    ctx.drawImage(imgMeteorito, m.x - m.r, m.y - m.r, m.r * 2, m.r * 2);

    ctx.fillStyle = "white";
    ctx.font = "22px Arial Black";
    ctx.fillText(m.valor, m.x - 12, m.y + 8);
  });
}


// =========================================
// L칍GICA DEL JUEGO
// =========================================

document.addEventListener("keydown", (e) => {
  if (e.key === " ") {
    verificarColisionDisparo();
  }
});

function verificarColisionDisparo() {
  meteoritos.forEach((m, i) => {
    if (
      m.y < nave.y &&
      Math.abs(m.x - (nave.x + nave.w / 2)) < m.r
    ) {
      if (m.valor === respuestaCorrecta) {
        explosionSound.play();
        score += 10;
        meteoritos.splice(i, 1);
        nuevaPregunta();
      } else {
        score -= 5;
      }

      document.getElementById("score").innerText =
        "Puntuaci칩n: " + score;
    }
  });
}


// =========================================
// BUCLE PRINCIPAL
// =========================================

function update() {
  // Fondo
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(imgFondo, 0, 0, canvas.width, canvas.height);

  // Dibujar
  drawNave();
  drawMeteoritos();

  // Mover meteoritos
  meteoritos.forEach((m) => (m.y += m.speed));

  // Eliminar meteoritos que salen del mapa
  meteoritos = meteoritos.filter((m) => m.y < canvas.height + 50);

  requestAnimationFrame(update);
}

setInterval(crearMeteorito, 1500);
update();

</script>
</body>
</html>
