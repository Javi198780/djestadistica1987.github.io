<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Distribuci√≥n Normal ‚Äì Enfermer√≠a</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #eef2f5;
    padding: 30px;
}
.contenedor {
    background: white;
    max-width: 800px;
    margin: auto;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 0 12px rgba(0,0,0,0.15);
}
h2 { color: #007bff; }
input, select {
    width: 100%;
    padding: 8px;
    margin-bottom: 12px;
}
button {
    width: 100%;
    padding: 10px;
    background: #007bff;
    color: white;
    border: none;
    font-size: 16px;
    border-radius: 6px;
    cursor: pointer;
}
button:hover { background: #0056b3; }
canvas {
    margin-top: 20px;
    border: 1px solid #ccc;
}
.pasos {
    margin-top: 15px;
    font-size: 16px;
}
</style>
</head>

<body>

<div class="contenedor">
<h2>Distribuci√≥n Normal ‚Äì Aplicaci√≥n en Enfermer√≠a</h2>

<label>Media (Œº)</label>
<input type="number" id="media" step="any" placeholder="Ej: 120">

<label>Desviaci√≥n est√°ndar (œÉ)</label>
<input type="number" id="desviacion" step="any" placeholder="Ej: 10">

<label>Tipo de c√°lculo</label>
<select id="tipo">
    <option value="uno">Un valor: P(X ‚â§ x)</option>
    <option value="dos">Dos valores: P(a ‚â§ X ‚â§ b)</option>
</select>

<label>Valor X o L√≠mite inferior (a)</label>
<input type="number" id="x1" step="any">

<label>Valor superior (b) ‚Äì solo si eliges dos valores</label>
<input type="number" id="x2" step="any">

<button onclick="calcular()">Calcular y Graficar</button>

<div class="pasos" id="pasos"></div>

<canvas id="grafico" width="700" height="320"></canvas>
</div>

<script>
// Funci√≥n error
function erf(x) {
    const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741;
    const a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
    const sign = x < 0 ? -1 : 1;
    x = Math.abs(x);
    const t = 1 / (1 + p * x);
    const y = 1 - (((((a5*t + a4)*t + a3)*t + a2)*t + a1)*t * Math.exp(-x*x));
    return sign * y;
}

function normalCDF(x, mu, sigma) {
    return 0.5 * (1 + erf((x - mu) / (sigma * Math.sqrt(2))));
}

function normalPDF(x, mu, sigma) {
    return (1 / (sigma * Math.sqrt(2 * Math.PI))) *
           Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
}

function calcular() {
    const mu = parseFloat(media.value);
    const sigma = parseFloat(desviacion.value);
    const tipo = document.getElementById("tipo").value;
    const a = parseFloat(document.getElementById("x1").value);
    const b = parseFloat(document.getElementById("x2").value);

    if (isNaN(mu) || isNaN(sigma) || isNaN(a) || sigma <= 0) {
        pasos.innerHTML = "‚ö†Ô∏è Ingrese valores v√°lidos.";
        return;
    }

    let prob, texto;

    if (tipo === "uno") {
        prob = normalCDF(a, mu, sigma);
        texto = `
        <strong>PASO A PASO:</strong><br>
        Z = (${a} ‚àí ${mu}) / ${sigma} = ${((a-mu)/sigma).toFixed(2)}<br>
        P(X ‚â§ ${a}) = <strong>${prob.toFixed(4)}</strong><br><br>
        üìå Interpretaci√≥n cl√≠nica:<br>
        El ${(prob*100).toFixed(2)}% de los pacientes presenta un valor
        menor o igual a ${a}.
        `;
        dibujarGrafico(mu, sigma, -Infinity, a, prob);
    } else {
        if (isNaN(b) || b <= a) {
            pasos.innerHTML = "‚ö†Ô∏è El valor superior debe ser mayor que el inferior.";
            return;
        }
        const p1 = normalCDF(a, mu, sigma);
        const p2 = normalCDF(b, mu, sigma);
        prob = p2 - p1;

        texto = `
        <strong>PASO A PASO:</strong><br>
        Z‚ÇÅ = (${a} ‚àí ${mu}) / ${sigma} = ${((a-mu)/sigma).toFixed(2)}<br>
        Z‚ÇÇ = (${b} ‚àí ${mu}) / ${sigma} = ${((b-mu)/sigma).toFixed(2)}<br><br>
        P(${a} ‚â§ X ‚â§ ${b}) = ${p2.toFixed(4)} ‚àí ${p1.toFixed(4)}<br>
        = <strong>${prob.toFixed(4)}</strong><br><br>
        üìå Interpretaci√≥n cl√≠nica:<br>
        El ${(prob*100).toFixed(2)}% de los pacientes se encuentra en este rango.
        `;
        dibujarGrafico(mu, sigma, a, b, prob);
    }

    pasos.innerHTML = texto;
}

function dibujarGrafico(mu, sigma, a, b, prob) {
    const canvas = document.getElementById("grafico");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const escalaX = canvas.width / 6;
    const escalaY = canvas.height * 8;

    // Campana
    ctx.beginPath();
    for (let i = -3; i <= 3; i += 0.01) {
        const x = mu + i * sigma;
        const y = normalPDF(x, mu, sigma);
        const px = (i + 3) * escalaX;
        const py = canvas.height - y * escalaY;
        if (i === -3) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
    }
    ctx.strokeStyle = "#007bff";
    ctx.lineWidth = 2;
    ctx.stroke();

    // √Årea sombreada
    ctx.beginPath();
    for (let i = -3; i <= 3; i += 0.01) {
        const x = mu + i * sigma;
        if (x >= a && x <= b || a === -Infinity && x <= b) {
            const y = normalPDF(x, mu, sigma);
            const px = (i + 3) * escalaX;
            const py = canvas.height - y * escalaY;
            ctx.lineTo(px, py);
        }
    }
    ctx.lineTo(canvas.width, canvas.height);
    ctx.lineTo(0, canvas.height);
    ctx.closePath();
    ctx.fillStyle = "rgba(0,123,255,0.3)";
    ctx.fill();

    // Texto porcentaje
    ctx.fillStyle = "#000";
    ctx.font = "16px Arial";
    ctx.fillText(
        (prob * 100).toFixed(2) + " %",
        canvas.width / 2 - 30,
        canvas.height / 2
    );
}
</script>

</body>
</html>
